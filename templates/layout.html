<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, width=device-width">

        <!-- http://getbootstrap.com/docs/4.5/ -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <!-- https://favicon.io/favicon-converter../ -->
        <link href="/static/favicon.ico" rel="icon">

        <link href="/static/styles.css" rel="stylesheet">

        <!-- http://getbootstrap.com/docs/4.5/ -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>
        <title>Cabinet {% block title %}{% endblock %}</title>

    </head>

    <body>

        <nav class="navbar navbar-expand-md navbar-light bg-light border">
            <a class="navbar-brand" href="/"><span class="blue">CA</span><span class="red"></span><span class="yellow">BI</span><span class="green">N</span><span class="red">ET</span></a>
            <button aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbar" data-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbar">
                {% if session.user_id %}
                    <ul class="navbar-nav mr-auto mt-2">
                        <li class="nav-item"><a class="nav-link" href="/upload" style="color: green;">UPLOAD</a></li>
                        <li class="nav-item"><a class="nav-link" href="#" style="color: red;" onclick="about()">ABOUT</a></li>
                    </ul>
                    <ul class="navbar-nav ml-auto mt-2">
                        <li class="nav-item">
                            <div class="dropdown">
                                <button style="font-size:24px;" onclick="dropMenu()" class="dropbtn">{{session.username   }}               <img src="static/user0.png" alt="user_image" style="size:16px;"></button>
                                <div id="dropdown" class="dropdown-content">
                                    <a href="/change_psswd_check">Change password</a>
                                    <a href="/change_email_psswd_check">Change E-mail</a>
                                    <a href="#" onclick = "delete_account()">Delete account</a>
                                    <a href="/logout">logout</a>
                                </div>
                            </div>
                        </li>
                        <li style="visibility:hidden;">space</li>

                    </ul>

                {% else %}
                    <ul class="navbar-nav mr-auto mt-2">
                        <li class="nav-item"><a class="nav-link" href="/upload">Upload</a></li>
                        <li class="nav-item"><a class="nav-link" href="#" onclick="about()">About</a></li>
                    </ul>

                    <ul class="navbar-nav ml-auto mt-2">
                        <li class="nav-item"><a class="nav-link" href="/register">Register</a></li>
                        <li class="nav-item"><a class="nav-link" href="/login">Log In</a></li>
                    </ul>
                {% endif %}
            </div>
        </nav>

        <script>
            function about()
            {
                alert("Thank you for the click. Now you are about to learn what this application does. Well, it's a web application and it's purpose is to store your files. You can upload different kinds of files ; namely, audio, video, image, documents etc. And then, you can download them, or delete them if you wish. So, here you are, enjoy! But first, you need to create an account, if you haven't already. And then, enjoy!!");
            }


                        /* When the user clicks on the button,
            toggle between hiding and showing the dropdown content */
            function dropMenu() {
            $("#dropdown").toggleClass("show");
            }

            // Close the dropdown if the user clicks outside of it
            window.onclick = function(event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = $(".dropdown-content");
                var i;
                for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
                }
            }
            }

            function delete_account(){
                if (confirm("Are you sure?") == true)
                {
                    $.post("/delete_account", function(){window.location.href = "/"});
                }
            }


        </script>

        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages%}
                    <header>
                        <div class="alert alert-primary border text-center" role="alert">
                            {{ message }}
                        </div>
                    </header>
                 {% endfor %}
            {% endif %}
        {% endwith %}

        <main class="container p-5">
            {% block main %}{% endblock %}
        </main>


    </body>

</html>
